## K-means

算法步骤

1. 初始k个聚类中心
2. 按与聚类中心的距离分成k类
3. 计算蔟内中心点，更新聚类中心
4. 重复23直至中心变化小于阀值

### k的选取

#### elbow method

计算簇内平方误差和，选择误差和不再聚类减小的k

#### silhouette method

计算样本与同蔟内其他样本的平均距离（蔟内不相似度）和样本与其他蔟内其他样本的平均距离的最小值（蔟间不相似度）

可计算出其轮廓系数，轮廓系数接近1，说明样本i聚类合理，接近-1说明样本i聚类不合理，silhouette score为每个样本轮廓系数的均值，选择score高的k值
$$
a(i)=\frac{1}{\left|C_{k}\right|-1} \sum_{j \neq C_{k}, i \neq j} d(i, j) \quad蔟内不相似度\\
b(i)=\min _{l \neq k} \frac{1}{\left|C_{l}\right|} \sum_{j \in C_{l}} d(i, j)\quad蔟间不相似度\\
s(i)=\frac{b(i)-a(i)}{\max\{a(i),b(i)\}}\quad轮廓系数
$$
对于只有一个点的蔟，其轮廓系数为0

### 选择初始聚类中心

随机选一个点作为聚类中心，之后选择的中心离现有的点越远概率越高，概率与最近聚类中心距离的平方成正比

### 性质

k-means必然会收敛但不一定保证收敛到全局最优解